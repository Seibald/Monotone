<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Accueil - Jeu</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Bienvenue dans le jeu</h1>
    <h2>Créer une session</h2>
    <form id="create-session-form">
        <input type="text" id="session_name" placeholder="Nom de la session" required>
        <button type="submit">Créer</button>
    </form>
    <div id="create-session-response"></div>

    <h2>Sessions disponibles</h2>
    <ul id="session-list">
        {% for session_name, players in sessions.items() %}
            <li>
                <strong>{{ session_name }}</strong> - {{ players|length }}/2 joueurs
                {% if players|length < 2 %}
                    <button class="join-session" data-session="{{ session_name }}">Rejoindre</button>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
    <script>
        // Création d'une session
        $('#create-session-form').submit(function (e) {
            e.preventDefault();
            $.post('/create_session', { session_name: $('#session_name').val() }, function (response) {
                $('#create-session-response').text(response.message);
                if (response.success) location.reload();
            });
        });

        // Rejoindre une session
        $('.join-session').click(function () {
            const sessionName = $(this).data('session');
            const playerName = prompt("Entrez votre nom :");
            if (playerName) {
                $.post('/join_session', { session_name: sessionName, player_name: playerName }, function (response) {
                    alert(response.message);
                    if (response.success) {
                        window.location.href = '/game/' + sessionName;
                    }
                });
            }
        });
    </script>
</body>
</html>
